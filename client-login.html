<!DOCTYPE html>
<html class="dark" lang="fr">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Connexion Client - ESSOR ACTIVE</title>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: { "primary": "#49e619", "primary-hover": "#3cd010", "background-dark": "#0a0f08", "surface-dark": "#152111" },
                    fontFamily: { "display": ["Manrope", "sans-serif"] },
                    borderRadius: { "DEFAULT": "1rem", "lg": "1.5rem", "2xl": "3rem" }
                }
            }
        }
    </script>
    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        body {
            background-color: #0a0f08;
        }
    </style>
</head>

<body class="min-h-screen font-display flex flex-col items-center justify-center p-6">
    <div class="w-full max-w-[400px] space-y-8">
        <!-- Logo/Title -->
        <div class="text-center space-y-2">
            <div
                class="w-16 h-16 bg-primary rounded-2xl flex items-center justify-center mx-auto shadow-[0_0_20px_rgba(73,230,25,0.4)] mb-4">
                <span class="material-symbols-outlined text-background-dark text-4xl">login</span>
            </div>
            <h1 class="text-3xl font-extrabold text-white tracking-tight">Espace <span
                    class="text-primary">Client</span></h1>
            <p class="text-gray-400 text-sm">Ravis de vous revoir ! Continuez votre progression.</p>
        </div>

        <!-- Login Form -->
        <form id="login-form"
            class="bg-surface-dark/50 backdrop-blur-xl p-8 rounded-[2.5rem] border border-white/5 space-y-5 shadow-2xl">
            <div>
                <label class="block text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 px-1">Adresse
                    Email</label>
                <input type="email" id="email" required
                    class="w-full bg-black/40 border border-white/10 rounded-2xl px-5 py-4 text-white focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all outline-none"
                    placeholder="jean@exemple.com">
            </div>

            <div>
                <label class="block text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 px-1">Mot de
                    passe</label>
                <input type="password" id="password" required
                    class="w-full bg-black/40 border border-white/10 rounded-2xl px-5 py-4 text-white focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all outline-none"
                    placeholder="••••••••">
            </div>

            <button type="submit"
                class="w-full bg-primary hover:bg-primary-hover text-background-dark text-lg font-black py-5 rounded-full shadow-[0_4px_30px_rgba(73,230,25,0.3)] transition-all active:scale-[0.98] flex items-center justify-center gap-2 mt-4">
                <span>SE CONNECTER</span>
                <span class="material-symbols-outlined">bolt</span>
            </button>
        </form>

        <p class="text-center text-gray-500 text-sm">
            Nouveau chez ESSOR ? <a href="client-register.html"
                class="text-primary font-bold hover:underline">S'inscrire</a>
        </p>
    </div>

    <script>
        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            const originalText = btn.innerHTML;

            btn.innerHTML = '<span class="material-symbols-outlined animate-spin">sync</span> Connexion...';
            btn.disabled = true;

            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            try {
                const res = await fetch('/api/client/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });

                if (res.ok) {
                    const result = await res.json();
                    localStorage.setItem('clientUser', JSON.stringify(result.user || { name: result.name, email: result.email }));
                    localStorage.setItem('isClientLoggedIn', 'true');
                    window.location.href = 'dashboard.html';
                } else {
                    const error = await res.json();
                    alert(error.message || 'Identifiants incorrects');
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }
            } catch (err) {
                // Fallback demo
                alert('Mode démonstration : Connecté automatiquement');
                localStorage.setItem('isClientLoggedIn', 'true');
                window.location.href = 'dashboard.html';
            }
        });
    </script>
</body>

</html>